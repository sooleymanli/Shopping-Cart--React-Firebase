{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/Fuad/Desktop/new/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _toConsumableArray from\"C:/Users/Fuad/Desktop/new/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _asyncToGenerator from\"C:/Users/Fuad/Desktop/new/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:/Users/Fuad/Desktop/new/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{event}from'jquery';import React,{useState,useEffect}from'react';import'./Order.css';import{setDoc,doc,onSnapshot,updateDoc}from\"firebase/firestore\";import{getAuth,onAuthStateChanged}from\"firebase/auth\";import{db}from'../Firebase';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function Order(props){var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),operatorNum=_useState2[0],setOperatorNum=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),telNum=_useState4[0],setTelNum=_useState4[1];var _useState5=useState(\"none\"),_useState6=_slicedToArray(_useState5,2),errOperatorNum=_useState6[0],setErrOperatorNum=_useState6[1];var _useState7=useState(\"none\"),_useState8=_slicedToArray(_useState7,2),errTelNum=_useState8[0],setErrTelNum=_useState8[1];var _useState9=useState({}),_useState10=_slicedToArray(_useState9,2),history=_useState10[0],setHistory=_useState10[1];var _useState11=useState(props.userEmail),_useState12=_slicedToArray(_useState11,2),userEmail=_useState12[0],setUserEmail=_useState12[1];var _useState13=useState(props.userId),_useState14=_slicedToArray(_useState13,2),userId=_useState14[0],setUserId=_useState14[1];var telChange=function telChange(e){var tel=e.target.value;var newTel=tel.slice(0,7);setTelNum(newTel);};var opChange=function opChange(e){var tel=e.target.value;var newTel=tel.slice(0,3);setOperatorNum(newTel);};function setOrder(_x){return _setOrder.apply(this,arguments);}function _setOrder(){_setOrder=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(object){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return setDoc(doc(db,userEmail,\"history\"),object);case 2:case\"end\":return _context.stop();}}},_callee);}));return _setOrder.apply(this,arguments);};function setStore(_x2){return _setStore.apply(this,arguments);}function _setStore(){_setStore=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(changedObject){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return setDoc(doc(db,userEmail,\"cart\"),changedObject);case 2:case\"end\":return _context2.stop();}}},_callee2);}));return _setStore.apply(this,arguments);};function updateHistory(_x3){return _updateHistory.apply(this,arguments);}function _updateHistory(){_updateHistory=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(newArray){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return updateDoc(doc(db,userEmail,\"history\"),{array:newArray});case 2:case\"end\":return _context3.stop();}}},_callee3);}));return _updateHistory.apply(this,arguments);};var auth=getAuth();useEffect(function(){onAuthStateChanged(auth,function(user){if(user){onSnapshot(doc(db,user.email,\"history\"),function(doc){var historyS=doc.data();setHistory(historyS);});}else{console.log(\"giris yoxdur\");}});},[]);var orderFinish=function orderFinish(e){e.preventDefault();var d=new Date();var day=d.getDate();var month=d.getMonth();month=month+1;var year=d.getFullYear();var newDate=\"\".concat(day,\".\").concat(month,\".\").concat(year);if(telNum!==\"\"&&operatorNum!==\"\"){props.success();if(history===undefined){setOrder({array:[{date:newDate,products:_toConsumableArray(props.products),phone:\"(+994) (\".concat(operatorNum,\") \").concat(telNum,\" \")}]});}else{updateHistory([].concat(_toConsumableArray(history.array),[{date:newDate,products:_toConsumableArray(props.products),phone:\"(+994) (\".concat(operatorNum,\") \").concat(telNum,\" \")}]));}setStore({cartdata:[]});props.hideOrderBody();}else{if(telNum===\"\"){setErrTelNum(\"3px solid red\");}else{setErrTelNum(\"none\");}if(operatorNum===\"\"){setErrOperatorNum(\"3px solid red\");}else{setErrOperatorNum(\"none\");}}};return/*#__PURE__*/_jsx(\"div\",{className:\"order animate__animated animate__fadeInDownBig \",style:{display:props.show},children:/*#__PURE__*/_jsxs(\"div\",{className:\"order-body\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Sifari\\u015F et\"}),/*#__PURE__*/_jsx(\"div\",{className:\"tel-input\",children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:orderFinish,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"order-inputs\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"country-number\",defaultValue:\"+994\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",id:\"operator-number\",placeholder:\"050\",value:operatorNum,onChange:opChange,style:{border:errOperatorNum}}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",id:\"tel\",placeholder:\"9993366\",value:telNum,onChange:telChange,style:{border:errTelNum}})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"order-buttons\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"submit\",id:\"submit\",value:\"Sifari\\u015F ver\"}),/*#__PURE__*/_jsx(\"input\",{type:\"button\",id:\"cancel\",value:\"L\\u0259\\u011Fv et\",onClick:props.hideOrderBody})]})]})})]})});}","map":{"version":3,"sources":["C:/Users/Fuad/Desktop/new/src/Components/Order.js"],"names":["event","React","useState","useEffect","setDoc","doc","onSnapshot","updateDoc","getAuth","onAuthStateChanged","db","Order","props","operatorNum","setOperatorNum","telNum","setTelNum","errOperatorNum","setErrOperatorNum","errTelNum","setErrTelNum","history","setHistory","userEmail","setUserEmail","userId","setUserId","telChange","e","tel","target","value","newTel","slice","opChange","setOrder","object","setStore","changedObject","updateHistory","newArray","array","auth","user","email","historyS","data","console","log","orderFinish","preventDefault","d","Date","day","getDate","month","getMonth","year","getFullYear","newDate","success","undefined","date","products","phone","cartdata","hideOrderBody","display","show","border"],"mappings":"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","sourcesContent":["import { event } from 'jquery'\r\nimport React, { useState,useEffect } from 'react'\r\nimport './Order.css'\r\nimport {setDoc,doc,onSnapshot,updateDoc} from \"firebase/firestore\"\r\nimport { getAuth, onAuthStateChanged } from \"firebase/auth\"\r\n\r\nimport {db} from '../Firebase'\r\n\r\nexport default function Order(props) {\r\n\r\n    const [operatorNum,setOperatorNum]=useState(\"\")\r\n    const [telNum,setTelNum]=useState(\"\")\r\n    const [errOperatorNum,setErrOperatorNum]=useState(\"none\")\r\n    const [errTelNum,setErrTelNum]=useState(\"none\")\r\nconst [history,setHistory]=useState({})\r\nconst [userEmail,setUserEmail]=useState(props.userEmail)\r\nconst [userId,setUserId]=useState(props.userId)\r\n\r\n    \r\n\r\nconst telChange = (e)=>{\r\nlet tel =e.target.value\r\nlet newTel = tel.slice(0,7)\r\nsetTelNum(newTel)\r\n}\r\nconst opChange = (e)=>{\r\n    let tel =e.target.value\r\n    let newTel = tel.slice(0,3)\r\n    setOperatorNum(newTel)\r\n    }\r\n\r\n\r\n    async function setOrder(object) {\r\n        await setDoc(doc(db, userEmail, \"history\"), object);\r\n        \r\n      };\r\n\r\n      async function setStore(changedObject) {\r\n        await setDoc(doc(db, userEmail, \"cart\"), changedObject);\r\n        \r\n      };\r\n     \r\n\r\n      async function updateHistory(newArray) {\r\n        await updateDoc(doc(db, userEmail, \"history\"),{array:newArray});\r\n        \r\n      };\r\n   \r\nconst auth=getAuth()\r\nuseEffect(() => {\r\n    onAuthStateChanged(auth, (user) => {\r\n        if (user) {\r\n        \r\n  \r\n  \r\n            onSnapshot(doc(db, user.email, \"history\"), (doc) => {\r\n\r\n                let historyS=doc.data()\r\n                setHistory(historyS)\r\n                \r\n                \r\n                    })\r\n                \r\n  \r\n  \r\n        } else {\r\n          console.log(\"giris yoxdur\")\r\n  \r\n        }\r\n      })\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n  \r\n\r\n  \r\n\r\n\r\n    \r\n}, [])\r\n\r\n\r\nconst orderFinish = (e)=>{\r\n    e.preventDefault()\r\n   \r\n  \r\n    let d=new Date()\r\n    let day= d.getDate()\r\n    let month =d.getMonth()\r\n    month=month+1\r\n    let year = d.getFullYear()\r\n    let newDate =`${day}.${month}.${year}`\r\n    \r\n\r\n\r\n    if(telNum!==\"\"&&operatorNum!==\"\"){\r\n        props.success()\r\n    \r\n\r\n\r\n        if(history===undefined){\r\n          \r\n            setOrder({array:[{ date:newDate,\r\n                products:[...props.products],\r\n                phone:`(+994) (${operatorNum}) ${telNum} `}]\r\n               \r\n            })\r\n            \r\n          \r\n           \r\n        }else{\r\n           \r\n            updateHistory([...history.array,{ date:newDate,\r\n                products:[...props.products],\r\n                phone:`(+994) (${operatorNum}) ${telNum} `}])\r\n                \r\n        }\r\n           \r\n\r\n        setStore({cartdata:[]})\r\n        props.hideOrderBody()\r\n\r\n\r\n\r\n       \r\n    }else{\r\n  if(telNum===\"\"){\r\nsetErrTelNum(\"3px solid red\")\r\n  } else{\r\n    setErrTelNum(\"none\")\r\n\r\n  }\r\nif(operatorNum===\"\"){\r\n      setErrOperatorNum(\"3px solid red\")\r\n  }else{\r\n    setErrOperatorNum(\"none\")\r\n\r\n  }\r\n    }\r\n\r\n\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n    return (\r\n        <div className=\"order animate__animated animate__fadeInDownBig \" style={{display:props.show}}>\r\n        <div className=\"order-body\">\r\n\r\n<h2>Sifariş et</h2>\r\n<div className=\"tel-input\">\r\n<form onSubmit={orderFinish}>\r\n    <div className=\"order-inputs\">\r\n<input type=\"text\" id=\"country-number\"  defaultValue=\"+994\" />\r\n<input type=\"number\" id=\"operator-number\"  placeholder=\"050\" value={operatorNum}  onChange={opChange} style={{border:errOperatorNum}}/>\r\n<input type=\"number\" id=\"tel\" placeholder=\"9993366\"   value={telNum} onChange={telChange} style={{border:errTelNum}}/>\r\n</div>\r\n<div className=\"order-buttons\">\r\n<input type=\"submit\" id =\"submit\"value=\"Sifariş ver\" />\r\n<input type=\"button\" id =\"cancel\"value=\"Ləğv et\" onClick={props.hideOrderBody}/>\r\n</div>\r\n</form>\r\n\r\n</div>\r\n\r\n        </div>\r\n            \r\n        </div>\r\n    )\r\n}\r\n"]},"metadata":{},"sourceType":"module"}